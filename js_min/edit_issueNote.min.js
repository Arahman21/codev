function editIssueNote(a){var b=jQuery("#formGetIssueNoteText");b.find("input[name=bugid]").val(a),jQuery.ajax({type:"POST",dataType:"json",url:b.attr("action"),data:b.serialize(),success:function(b){var c=b.issuenoteid;if(0!==c){var d=b.issuenote_text;jQuery("#dialog_editIssueNote").find("textarea[name=issuenote_text]").val(d)}jQuery("#formEditIssueNote").find("input[name=bugid]").val(a),jQuery("#formEditIssueNote").find("input[name=issuenoteid]").val(c);var e=editIssueNoteSmartyData.i18n_task+" "+a+" - "+editIssueNoteSmartyData.i18n_editTimesheetNote;jQuery("#dialog_editIssueNote").dialog("option","title",e),jQuery("#editIssueNoteDialogDesc").text("Task "+a),jQuery("#cb_isTimesheetNote").prop("checked",!0),jQuery("#dialog_editIssueNote").dialog("open")},error:function(b){console.error("editIssueNote",a,b),alert("ERROR: could not get IssueNoteText")}})}function markIssueNoteAsRead(a){var b=jQuery("#formMarkIssueNoteAsRead");b.find("input[name=bugid]").val(a),jQuery.ajax({type:"POST",url:b.attr("action"),data:b.serialize(),success:function(b){var c=jQuery("#b_markAsRead_"+a);c.off("click"),c.attr("src","images/b_markAsRead_grey.png");var d=jQuery("#issueNotes_tr"+a);d.css("background-color","#FFFFFF")},error:function(b){console.error("markIssueNoteAsRead",a,b),alert("ERROR: could not get mark IssueNote as read.")}})}function deleteNote(a,b){if(confirm(editIssueNoteSmartyData.i18n_deleteTimesheetNoteForTask+a+" ?")){var c=jQuery("#formDeleteNote");c.find("input[name=bugid]").val(a),c.find("input[name=bugnote_id]").val(b),jQuery.ajax({type:"POST",url:c.attr("action"),data:c.serialize(),success:function(b){var c=jQuery("#issueNotes_table").dataTable(),d=jQuery("#issueNotes_tr"+a).get(0);return c.fnDeleteRow(c.fnGetPosition(d)),!1},error:function(c){console.error("deleteNote",a,b,c),alert("ERROR: could not deleteNote.")}})}}jQuery(document).ready(function(){jQuery("#dialog_editIssueNote").dialog({autoOpen:!1,modal:!0,hide:"fade",height:"auto",width:"auto",closeOnEscape:!0,buttons:{Ok:function(){var a=jQuery("#cb_isTimesheetNote").attr("checked")?1:0;jQuery("#dialog_editIssueNote").find("input[name=isTimesheetNote]").val(a),jQuery("#formEditIssueNote").submit(),jQuery("#dialog_editIssueNote").find("textarea[name=issuenote_text]").val(""),jQuery("#dialog_editIssueNote").dialog("close")},Cancel:function(){jQuery("#dialog_editIssueNote").find("textarea[name=issuenote_text]").val(""),jQuery(this).dialog("close")}}});jQuery("#formEditIssueNote").unbind("submit.notes").bind("submit.notes",function(a){a.preventDefault();var b=jQuery(this);jQuery.ajax({type:"POST",url:b.attr("action"),data:b.serialize(),success:function(a){jQuery("#weekTaskDetailsDiv").html(jQuery.trim(a)),updateWidgets("#weekTaskDetailsDiv")},error:function(a){console.error("formEditIssueNote",a),alert("ERROR: could not edit IssueNote.")}})}),jQuery(".js-add-note-link").click(function(a){var b=this.getAttribute("data-bugId");a.preventDefault(),editIssueNote(b)}),jQuery(".js-markNoteAsRead-link").click(function(a){var b=this.getAttribute("data-bugId");a.preventDefault(),markIssueNoteAsRead(b)}),jQuery(".js-deleteNote-link").click(function(a){var b=this.getAttribute("data-bugId"),c=this.getAttribute("data-bugnoteId");a.preventDefault(),deleteNote(b,c)})});

