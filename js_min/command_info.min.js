function setGanttOptions(){gantt.config.start_date=new Date(commandInfoSmartyData.ganttWindowStartDate);gantt.config.date_grid="%Y-%m-%d";gantt.config.readonly=true;gantt.config.row_height=22;gantt.config.date_scale="%d/%m";gantt.config.subscales=[{unit:"month",step:1,date:"%F %Y"}];gantt.config.xml_date="%d-%m-%Y %H:%i";gantt.templates.scale_cell_class=function(date){if(date.getDay()==0||date.getDay()==6){return"weekend"}};gantt.templates.task_cell_class=function(item,date){if(date.getDay()==0||date.getDay()==6){return"weekend"}};gantt.templates.tooltip_text=function(start,end,task){return task.tooltipHtml};gantt.templates.task_text=function(start,end,task){return task.barText};gantt.templates.rightside_text=function(start,end,task){return task.assignedTo};gantt.config.columns=[{name:"text",label:"Task",width:"*",tree:true},{name:"start_date",label:"Start",align:"center"},{name:"end_date",label:"End",template:function(obj){return obj.end_date_real}},{name:"duration",label:"Backlog",align:"center",template:function(obj){return obj.duration_real}}];gantt.attachEvent("onBeforeTaskDisplay",function(id,task){var summaryFilter=$("#summaryFilter").val();if(task.text.toString().toLowerCase().indexOf(summaryFilter)>=0){return true}if(task.summary.toString().toLowerCase().indexOf(summaryFilter)>=0){return true}if(task.assignedTo.toString().toLowerCase().indexOf(summaryFilter)>=0){return true}return false})}function computeGantt(){$("#ganttBtImg").attr("src","images/spinner.gif");var jsonGanttTasksPromise=$.ajax({url:commandInfoSmartyData.ajaxPage,data:{action:"getGanttTasks",commandId:commandInfoSmartyData.commandId},type:"post",dataType:"json",success:function(data){if("SUCCESS"===data.statusMsg){jsonGanttTasks=data.ganttTasks;gantt.config.end_date=new Date(data.ganttEndDate)}else{$("#ganttBtImg").attr("src","images/b_refresh.png");console.error("Ajax statusMsg",data.statusMsg);alert(data.statusMsg)}},error:function(jqXHR,textStatus,errorThrown){$("#ganttBtImg").attr("src","images/b_refresh.png");console.error(textStatus,errorThrown);alert("ERROR: Please contact your CodevTT administrator")}});$.when(jsonGanttTasksPromise).done(function(){gantt.parse(jsonGanttTasks);console.log("number of tasks currently loaded in the gantt",gantt.getTaskCount());console.log("number of tasks visible on the screen (those that are not collapsed)",gantt.getVisibleTaskCount());$("#ganttBtImg").attr("src","images/b_refresh.png")})}$("#tab_gantt").on("tabscreate",function(event,ui){setGanttOptions();gantt.init("gantt_here");computeGantt()});$("#summaryFilter").bind("enterKey",function(e){gantt.refreshData()});$("#summaryFilter").keyup(function(e){if(e.keyCode==13){$(this).trigger("enterKey")}});jQuery(document).ready(function(){jQuery("#cmdid").change(function(){if("0"!==this.value){var form=jQuery("#mainForm");form.find("input[name=action]").val("displayCommand");form.submit()}});jQuery("#btDisplayPage").click(function(){var form=jQuery("#mainForm");form.find("input[name=action]").val("displayCommand");form.submit()});jQuery("#btCmdStateFilter").click(function(event){event.preventDefault();jQuery("#setCmdStateFilter_dialog_form").dialog("open")});jQuery("#setCmdStateFilter_dialog_form").dialog({autoOpen:false,height:"auto",width:500,modal:true,buttons:[{text:commandInfoSmartyData.i18n_OK,click:function(){var form=jQuery("#formSetStateFilter");var checkItems="";jQuery(".cb_cmdStateFilter").each(function(){var itemName=jQuery(this).attr("name");var isChecked=jQuery(this).attr("checked")?1:0;checkItems+=itemName+":"+isChecked+","});form.find("input[name=checkedCmdStateFilters]").val(checkItems);form.find("input[name=cmdid]").val(jQuery("#cmdid").val());form.submit()}},{text:commandInfoSmartyData.i18n_Cancel,click:function(){jQuery(this).dialog("close")}}]});jQuery("input[type=radio]").change(function(){if(jQuery(this).attr("id")=="radio1"){jQuery(".provisionTotalList").show();jQuery(".provisionsList").hide()}else if(jQuery(this).attr("id")=="radio2"){jQuery(".provisionTotalList").hide();jQuery(".provisionsList").show()}});jQuery.ajax({url:"js_min/datatable.min.js",dataType:"script",cache:true})});